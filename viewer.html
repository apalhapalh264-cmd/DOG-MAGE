<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dogmage Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black min-h-screen flex items-center justify-center m-0 overflow-hidden">
    <div id="loader" class="text-gray-700 text-[10px] tracking-[0.5em] uppercase animate-pulse">Memuat Gambar...</div>
    <img id="img" class="hidden max-w-full max-h-full object-contain shadow-2xl">

    <script>
        const path = window.location.pathname.split('/').filter(p => p).pop();
        const img = document.getElementById('img');
        const loader = document.getElementById('loader');

        if (!path || path === 'index.html' || path === 'viewer.html') {
            window.location.href = '/index.html';
        } else {
            // Minta data ke Edge Function
            async function fetchImage() {
                try {
                    const res = await fetch(`/api/get?name=${path}`);
                    if (res.ok) {
                        const blob = await res.blob();
                        img.src = URL.createObjectURL(blob);
                        img.onload = () => {
                            loader.classList.add('hidden');
                            img.classList.remove('hidden');
                            document.title = path.toUpperCase() + " â€” DOGMAGE";
                        };
                    } else {
                        loader.innerText = "404: FOTO TIDAK ADA";
                    }
                } catch (e) {
                    loader.innerText = "ERROR KONEKSI";
                }
            }
            fetchImage();
        }
    </script>
</body>
</html>

